<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Auth Page</title>

  <!-- Bootstrap 4 -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />

  <style>
    body {
      background: #f4f7fc;
      font-family: Arial, sans-serif;
    }
    .auth-card {
      width: 420px;
      border-radius: 15px;
      border: none;
    }
    .auth-card input {
      height: 45px;
      border-radius: 8px;
    }
    .auth-card button {
      height: 45px;
      border-radius: 8px;
    }
    .nav-tabs .nav-link {
      border: none;
      font-weight: bold;
      font-size: 17px;
      color: #555;
    }
    .nav-tabs .nav-link.active {
      color: #007bff !important;
      border-bottom: 2px solid #007bff;
    }
    @media (max-width: 576px) {
  .auth-card {
    width: 100% !important;
    margin: 0 15px;
    padding: 20px;
  }

  .nav-tabs .nav-link {
    font-size: 15px; /* slightly smaller */
  }

  .auth-card input,
  .auth-card button {
    height: 42px; /* more compact for mobile */
  }
    }
  </style>
</head>
<body>

  <div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
    <div class="card shadow p-4 auth-card">

      <ul class="nav nav-tabs justify-content-center mb-4" id="authTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="login-tab" data-toggle="tab" href="#login" role="tab">Login</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="signup-tab" data-toggle="tab" href="#signup" role="tab">Sign Up</a>
        </li>
      </ul>

      <div id="alert-placeholder"></div>

      <div class="tab-content">

        <!-- LOGIN -->
        <div class="tab-pane fade show active" id="login" role="tabpanel">
          <h4 class="text-center mb-3">Welcome Back</h4>
          <form id="loginForm">
            <div class="form-group">
              <label>Email</label>
              <input id="loginEmail" type="email" class="form-control" placeholder="Enter email" required>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input id="loginPassword" type="password" class="form-control" placeholder="Enter password" required>
            </div>
            <button type="submit" class="btn btn-primary btn-block mt-3">Login</button>
          </form>
        </div>

        <!-- SIGNUP -->
        <div class="tab-pane fade" id="signup" role="tabpanel">
          <h4 class="text-center mb-3">Create Account</h4>
          <form id="signupForm">
            <div class="form-group">
              <label>Full Name</label>
              <input id="fullName" type="text" class="form-control" placeholder="Enter your name" required>
            </div>
            <div class="form-group">
              <label>Email</label>
              <input id="signupEmail" type="email" class="form-control" placeholder="Enter email" required>
            </div>
            <div class="form-group">
              <label>Password</label>
              <input id="signupPassword" type="password" class="form-control" placeholder="Create password" required>
            </div>
            <div class="form-group">
              <label>Confirm Password</label>
              <input id="confirmPassword" type="password" class="form-control" placeholder="Confirm password" required>
            </div>
            <button type="submit" class="btn btn-success btn-block mt-3">Sign Up</button>
          </form>
        </div>

      </div>

    </div>
  </div>

  <!-- jQuery + Popper + Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
    function showAlert(message, type = "success") {
    const placeholder = document.getElementById("alert-placeholder");
    placeholder.innerHTML = `
      <div class="alert alert-${type} alert-dismissible fade show" role="alert">
        ${message}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
    `;
  }

  // SIGNUP
  document.getElementById("signupForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const fullName = document.getElementById("fullName").value;
  const email = document.getElementById("signupEmail").value;
  const password = document.getElementById("signupPassword").value;
  const confirmPassword = document.getElementById("confirmPassword").value;

  if (password !== confirmPassword) {
    alert("Passwords do not match!");
    return;
  }

  const data = {
    fullName,
    email,
    password
  };

  const res = await fetch("http://localhost:5000/api/users/signup", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  const result = await res.json();

  alert(result.message);

  if (res.ok) {
    window.location.href = "index.html";
  }
}); 

  // LOGIN
document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = {
        email: document.getElementById("loginEmail").value,
        password: document.getElementById("loginPassword").value
    };

    const res = await fetch("http://localhost:5000/api/users/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });

    const result = await res.json();
    alert(result.message);

    if (result.token) {
        localStorage.setItem("token", result.token);

        alert("Login successful! Redirecting...");

        setTimeout(() => {
            window.location.href = "index.html"; // Redirect to homepage
        }, 500);
    }
});  // <-- This was missing


  </script>
  <script>
document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("token");
    const navbarUserArea = document.getElementById("navbarUserArea");

    if (token) {
        navbarUserArea.innerHTML = `
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="profileMenu" data-toggle="dropdown">
                    <img src="image/user.png" width="35" height="35" style="border-radius: 50%; object-fit: cover;">
                </a>

                <div class="dropdown-menu dropdown-menu-right shadow">
                    <a class="dropdown-item" href="profile.html">My Profile</a>
                    <a class="dropdown-item" href="bookings.html">My Bookings</a>
                    <a class="dropdown-item" href="settings.html">Settings</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item text-danger" id="logoutBtn" href="#">Logout</a>
                </div>
            </li>
        `;
    } else {
        navbarUserArea.innerHTML = `
            <li class="nav-item">
                <a href="auth.html" class="btn btn-primary px-3">Login</a>
            </li>
        `;
    }
});

// LOGOUT
document.addEventListener("click", (e) => {
    if (e.target.id === "logoutBtn") {
        localStorage.removeItem("token");
        window.location.href = "auth.html";
    }
});

exports.getMe = async (req, res) => {
  const user = await User.findById(req.user.id).select("-password");
  res.json(user);
};

</script>


</body>
</html>
